import{g as K,a as L,d as O,u as G,c as H}from"./menu.c17d1231.js";import{_ as q}from"./index.6d8fab14.js";import{l as M,r as m,n as T,o as U,c as D,p as E,e as u,a as t,w as s,g as $,t as J,F as B,f as x,E as j,x as Q,b as N,m as v,q as I}from"./vendor.c1fe1bd0.js";import{g as W}from"./ingredients.76045c10.js";const X=["href"],Y=x("\u7F16\u8F91"),Z=x("\u5220\u9664"),ee={emits:["update"],setup(P,{expose:y,emit:f}){const o=M({lists:[],currentPage:1,pageSize:10,total:0,loading:!0}),l=()=>{o.currentPage=1,b()},b=()=>{K({name:"",currentPage:o.currentPage,pageSize:o.pageSize}).then(c=>{const{list:e,pagination:{total:p}}=c;o.lists=e,o.total=p,o.loading=!1})};l();const h=c=>{L(c).then(e=>{e.ingredients=e.ingredients.map(p=>p.id),f("update",e)})},k=({id:c,name:e})=>{j.confirm(`\u60A8\u786E\u5B9A\u8981\u5220\u9664${e}\u5417\uFF1F`,"\u8B66\u544A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"\u8B66\u544A"}).then(()=>{O(c).then(()=>{Q({message:"\u5220\u9664\u6210\u529F\uFF01",type:"success"}),l()})})};return y({initData:l}),(c,e)=>{const p=m("el-table-column"),V=m("el-button"),d=m("el-table"),r=T("loading");return U(),D(B,null,[E(t(d,{data:u(o).lists,stripe:"",style:{width:"100%"}},{default:s(()=>[t(p,{prop:"name",label:"\u83DC\u8C31\u540D\u79F0",width:"180",align:"center"},{default:s(({row:i})=>[$("a",{href:i.link},J(i.name),9,X)]),_:1}),t(p,{prop:"remark",label:"\u5907\u6CE8",align:"center"}),t(p,{label:"\u64CD\u4F5C",align:"center"},{default:s(({row:i})=>[t(V,{type:"primary",size:"mini",onClick:z=>h(i.id)},{default:s(()=>[Y]),_:2},1032,["onClick"]),t(V,{type:"danger",size:"mini",onClick:z=>k(i)},{default:s(()=>[Z]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),[[r,u(o).loading]]),t(q,{page:u(o).currentPage,"onUpdate:page":e[0]||(e[0]=i=>u(o).currentPage=i),size:u(o).pageSize,"onUpdate:size":e[1]||(e[1]=i=>u(o).pageSize=i),total:u(o).total,onPagination:b},null,8,["page","size","total"])],64)}}},te={props:{select:{type:Array,required:!0,default(){return[]}}},emits:["update:select"],setup(P,{expose:y,emit:f}){const o=P,l=M({lists:[],currentPage:1,pageSize:10,total:0,loading:!0,isInit:!1}),b=N({get:()=>o.select,set:d=>f("update:select",d)}),h=()=>{l.currentPage=1,l.isInit=!0,I(()=>{c.value.clearSelection(),l.isInit=!1}),k()},k=()=>{W({name:"",currentPage:l.currentPage,pageSize:l.pageSize}).then(d=>{const{list:r,pagination:{total:i}}=d;l.lists=r,l.total=i,I(()=>e()),l.loading=!1})},c=v(null),e=()=>{const d=b.value.map(r=>typeof r=="number"?r:r.id);l.lists.map(r=>{d.indexOf(r.id)!==-1&&(l.isInit=!0,c.value.toggleRowSelection(r,!0))})},p=d=>{if(l.isInit)return l.isInit=!1,!1;b.value=d},V=d=>d.id;return h(),y({initData:h}),(d,r)=>{const i=m("el-table-column"),z=m("el-table"),_=T("loading");return U(),D(B,null,[E(t(z,{ref:(a,g)=>{g.table=a,c.value=a},data:u(l).lists,stripe:"",style:{width:"100%"},"row-key":V,onSelectionChange:p},{default:s(()=>[t(i,{type:"selection",width:"55","reserve-selection":!0}),t(i,{prop:"name",label:"\u98DF\u6750\u540D\u79F0",width:"180",align:"center"}),t(i,{prop:"price",label:"\u98DF\u6750\u4EF7\u683C",width:"180",align:"center"}),t(i,{prop:"remark",label:"\u5907\u6CE8",align:"center"})]),_:1},8,["data"]),[[_,u(l).loading]]),t(q,{page:u(l).currentPage,"onUpdate:page":r[0]||(r[0]=a=>u(l).currentPage=a),size:u(l).pageSize,"onUpdate:size":r[1]||(r[1]=a=>u(l).pageSize=a),total:u(l).total,onPagination:k},null,8,["page","size","total"])],64)}}},le={class:"control"},ae=x("\u65B0\u589E\u83DC\u5355"),ne=x("\u70B9\u51FB\u9009\u62E9"),oe={class:"dialog-footer"},se=x("\u53D6\u6D88"),ie=x("\u786E\u5B9A"),pe={setup(P){const y=v(null),f=v(!1),o=v(!1),l=v(!1),b=N(()=>l.value?"\u7F16\u8F91\u98DF\u6750":"\u65B0\u589E\u98DF\u6750"),h=_=>{j.confirm("\u60A8\u786E\u5B9A\u8981\u53D6\u6D88\u6DFB\u52A0\u98DF\u6750\u5417\uFF1F",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88"}).then(()=>{_()}).catch(()=>{})},k=v(null),c=v(null),e=v({name:"",link:"",remark:"",ingredients:[]}),p={name:[{required:!0,message:"\u8BF7\u8F93\u5165\u98DF\u8C31\u540D\u79F0",trigger:"blur"}],link:[{required:!0,message:"\u8BF7\u8F93\u5165\u98DF\u8C31\u94FE\u63A5",trigger:"blur"}],remark:[{required:!0,message:"\u8BF7\u8F93\u5165\u5907\u6CE8",trigger:"blur"}],ingredients:[{required:!0,message:"\u8BF7\u9009\u62E9\u98DF\u6750",trigger:"blur"}]},V=()=>{e.value={name:"",link:"",remark:"",ingredients:[]}},d=()=>{V(),l.value=!1,f.value=!0},r=_=>{l.value=!0,e.value=_,f.value=!0},i=()=>{y.value.validate(_=>{if(_){const a=l.value?G:H;e.value.ingredients=e.value.ingredients.map(g=>g.id?g.id:g),a(u(e)).then(g=>{f.value=!1,k.value.initData()})}})},z=()=>{o.value=!0,console.log(e.value.ingredients),I(()=>{c.value.initData()})};return(_,a)=>{const g=m("el-button"),C=m("el-input"),w=m("el-form-item"),F=m("el-badge"),A=m("el-form"),R=m("el-dialog");return U(),D(B,null,[$("div",le,[t(g,{type:"primary",onClick:d},{default:s(()=>[ae]),_:1})]),t(ee,{ref:(n,S)=>{S.tableRef=n,k.value=n},onUpdate:r},null,512),t(R,{modelValue:f.value,"onUpdate:modelValue":a[6]||(a[6]=n=>f.value=n),title:u(b),width:"500px","before-close":h},{default:s(()=>[t(A,{ref:(n,S)=>{S.formRef=n,y.value=n},model:e.value,rules:p,"label-width":"120px"},{default:s(()=>[t(w,{label:"\u83DC\u8C31\u540D\u79F0",prop:"name"},{default:s(()=>[t(C,{modelValue:e.value.name,"onUpdate:modelValue":a[0]||(a[0]=n=>e.value.name=n)},null,8,["modelValue"])]),_:1}),t(w,{label:"\u83DC\u8C31\u94FE\u63A5",prop:"link"},{default:s(()=>[t(C,{modelValue:e.value.link,"onUpdate:modelValue":a[1]||(a[1]=n=>e.value.link=n)},null,8,["modelValue"])]),_:1}),t(w,{label:"\u5907\u6CE8",prop:"remark"},{default:s(()=>[t(C,{modelValue:e.value.remark,"onUpdate:modelValue":a[2]||(a[2]=n=>e.value.remark=n),type:"textarea"},null,8,["modelValue"])]),_:1}),t(w,{label:"\u98DF\u6750",prop:"remark"},{default:s(()=>[t(F,{value:e.value.ingredients.length},{default:s(()=>[t(g,{type:"primary",onClick:z},{default:s(()=>[ne]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"]),t(R,{modelValue:o.value,"onUpdate:modelValue":a[4]||(a[4]=n=>o.value=n),width:"50%",title:"\u9009\u62E9\u98DF\u6750","append-to-body":""},{default:s(()=>[t(te,{ref:(n,S)=>{S.selectRef=n,c.value=n},select:e.value.ingredients,"onUpdate:select":a[3]||(a[3]=n=>e.value.ingredients=n)},null,8,["select"])]),_:1},8,["modelValue"])]),footer:s(()=>[$("span",oe,[t(g,{onClick:a[5]||(a[5]=n=>f.value=!1)},{default:s(()=>[se]),_:1}),t(g,{type:"primary",onClick:i},{default:s(()=>[ie]),_:1})])]),_:1},8,["modelValue","title"])],64)}}};export{pe as default};
